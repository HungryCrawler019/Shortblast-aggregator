generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // or any other supported provider, e.g., mysql, sqlite, etc.  
  url      = env("DATABASE_URL")
}

model Pools {
  id            Int      @id @default(autoincrement())
  address       String   @unique @db.VarChar(50)
  token_mint    String   @unique @db.VarChar(50)
  creator       String   @unique @db.VarChar(50)
  total_supply  Int
  reserve_token Int
  reserve_sol   Int
  bump          Int
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt
  isClosed      Boolean  @default(false) @map("is_closed")

  @@map("pools")
  @@ignore
}

model Token {
  id         Int          @id @default(autoincrement())
  address    String       @unique @db.VarChar(50)
  decimials  Int          @db.SmallInt
  unitAmount BigInt       @map("unit_amount")
  name       String?      @db.VarChar(32)
  symbol     String?      @db.VarChar(10)
  image      String?      @db.VarChar(10)
  TradingLog TradingLog[]

  @@map("tokens")
}

model TradingLog {
  id        BigInt      @id @default(autoincrement())
  signature String      @db.VarChar(100)
  tokenId   Int         @map("token_id")
  userId    Int?        @map("user_id")
  amount    BigInt
  kind      TradingKind

  token Token @relation(fields: [tokenId], references: [id])
  user  User? @relation(fields: [userId], references: [id])

  @@unique([tokenId, userId])
  @@map("trading_logs")
}

model User {
  id         Int     @id @default(autoincrement())
  address    String  @unique @db.VarChar(50)
  username   String? @unique @db.VarChar(20)
  referrerId Int?    @map("referrer_id")

  logs TradingLog[]

  @@map("users")
}

enum TradingKind {
  BUY  @map("buy")
  SELL @map("sell")

  @@map("trading_kind_enum")
}
